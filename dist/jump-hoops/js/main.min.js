(function(){angular.module("ahaLuminateApp",["ngSanitize","ngTouch","ui.bootstrap","ahaLuminateControllers"]),angular.module("ahaLuminateControllers",[]),angular.module("ahaLuminateApp").constant("APP_INFO",{version:"1.0.0"}),angular.module("ahaLuminateApp").run(["$rootScope","APP_INFO",function(a,b){var c;if(c=angular.element("[data-aha-luminate-root]"),""!==c.data("api-key")&&(a.apiKey=c.data("api-key")),a.apiKey||new Error("AHA Luminate Framework: No Luminate Online API Key is defined."),""!==c.data("cons-id")&&(a.consId=c.data("cons-id")),""!==c.data("auth-token")&&(a.authToken=c.data("auth-token")),""!==c.data("fr-id"))return a.frId=c.data("fr-id")}]),angular.element(document).ready(function(){var a;return a=["ahaLuminateApp"],angular.bootstrap(document,a)}),angular.module("ahaLuminateApp").factory("AuthService",["LuminateRESTService",function(a){return{login:function(b,c){var d;return d="method=login",b&&""!==b&&(d+="&"+b),a.luminateExtendConsRequest(d,!1,c)}}}]),angular.module("ahaLuminateApp").factory("LuminateRESTService",["$rootScope","$http","APP_INFO",function(a,b,c){return{request:function(c,d,e,f){if(d)if(a.apiKey){if(d+="&v=1.0&api_key="+a.apiKey+"&response_format=json&suppress_response_codes=true",!e||a.authToken)return e&&(d+="&auth="+a.authToken),f&&(d+="&fr_id="+a.frId+"&s_trID="+a.frId),b({method:"POST",url:c,data:d,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).then(function(a){return a})}else;else;},luminateExtendRequest:function(b,c,d,e,f){if(luminateExtend){if(c)return e&&(c+="&fr_id="+a.frId+"&s_trID="+a.frId),luminateExtend.api({api:b,data:c,requiresAuth:d,callback:f||angular.noop})}else;},teamraiserRequest:function(a,b,c){return this.request("CRTeamraiserAPI",a,b,c)},luminateExtendTeamraiserRequest:function(a,b,c,d){return this.luminateExtendRequest("teamraiser",a,b,c,d)},consRequest:function(a,b){return this.request("CRConsAPI",a,b,!1)},luminateExtendConsRequest:function(a,b,c){return this.luminateExtendRequest("cons",a,b,!1,c)}}}]),angular.module("ahaLuminateApp").factory("TeamraiserCompanyService",["LuminateRESTService",function(a){return{getCompanies:function(b,c){var d;return d="method=getCompaniesByInfo",b&&""!==b&&(d+="&"+b),a.luminateExtendTeamraiserRequest(d,!1,!0,c)},getCompanyList:function(b,c){var d;return d="method=getCompanyList",b&&""!==b&&(d+="&"+b),a.luminateExtendTeamraiserRequest(d,!1,!0,c)}}}]),angular.module("ahaLuminateApp").factory("TeamraiserParticipantService",["LuminateRESTService",function(a){return{getParticipants:function(b,c){var d;return d="method=getParticipants",b&&""!==b&&(d+="&"+b),a.luminateExtendTeamraiserRequest(d,!1,!0,c)}}}]),angular.module("ahaLuminateApp").factory("TeamraiserTeamService",["LuminateRESTService",function(a){return{getTeams:function(b,c){var d;return d="method=getTeamsByInfo",b&&""!==b&&(d+="&"+b),a.luminateExtendTeamraiserRequest(d,!1,!0,c)}}}]),angular.module("ahaLuminateControllers").controller("CompanyPageCtrl",["$scope","$location",function(a,b){return a.companyId=b.absUrl().split("company_id=")[1].split("&")[0]}]),angular.module("ahaLuminateControllers").controller("MainCtrl",["$scope","$httpParamSerializer","AuthService",function(a,b,c){return a.toggleLoginMenu=function(){return a.loginMenuOpen?delete a.loginMenuOpen:a.loginMenuOpen=!0},angular.element("body").on("click",function(b){if(a.loginMenuOpen&&0===angular.element(b.target).closest(".ym-header-login").length&&a.toggleLoginMenu(),!a.$$phase)return a.$apply()}),a.headerLoginInfo={user_name:"",password:""},a.submitHeaderLogin=function(){return c.login(b(a.headerLoginInfo),{error:function(){return angular.element(".js--default-header-login-form").submit()},success:function(){return a.headerLoginInfo.ng_nexturl&&""!==a.headerLoginInfo.ng_nexturl?window.location=a.headerLoginInfo.ng_nexturl:window.location=window.location.href}})},a.toggleWelcomeMenu=function(){return a.welcomeMenuOpen?delete a.welcomeMenuOpen:a.welcomeMenuOpen=!0},angular.element("body").on("click",function(b){if(a.welcomeMenuOpen&&0===angular.element(b.target).closest(".ym-header-welcome").length&&a.toggleWelcomeMenu(),!a.$$phase)return a.$apply()}),a.toggleSiteMenu=function(){return a.siteMenuOpen?delete a.siteMenuOpen:a.siteMenuOpen=!0},angular.element("body").on("click",function(b){if(a.siteMenuOpen&&0===angular.element(b.target).closest(".ym-site-menu").length&&a.toggleSiteMenu(),!a.$$phase)return a.$apply()})}]),angular.module("ahaLuminateControllers").controller("PersonalPageCtrl",["$scope","$location","$filter","$timeout","TeamraiserParticipantService",function(a,b,c,d,e){var f,g,h;return a.participantId=b.absUrl().split("px=")[1].split("&")[0],console.log(a.companyId),h=function(b,e){var f;return a.personalProgress={amountRaised:b||0,goal:e||0},a.personalProgress.amountRaisedFormatted=c("currency")(a.personalProgress.amountRaised/100,"$").replace(".00",""),a.personalProgress.goalFormatted=c("currency")(a.personalProgress.goal/100,"$").replace(".00",""),0===a.personalProgress.goal?a.personalProgress.rawPercent=0:(f=Math.ceil(a.personalProgress.amountRaised/a.personalProgress.goal*100),f>100&&(f=100),a.personalProgress.rawPercent=f),a.personalProgress.percent=0,a.$$phase||a.$apply(),d(function(){var b;if(b=a.personalProgress.percent,0!==a.personalProgress.goal&&(b=Math.ceil(a.personalProgress.amountRaised/a.personalProgress.goal*100)),b>100&&(b=100),a.personalProgress.percent=b,!a.$$phase)return a.$apply()},500)},e.getParticipants("fr_id="+a.frId+"&first_name="+encodeURIComponent("%%")+"&last_name="+encodeURIComponent("%")+"&list_filter_column=reg.cons_id&list_filter_text="+a.participantId,{error:function(){return h()},success:function(a){var b,c;return console.log(a),b=null!=(c=a.getParticipantsResponse)?c.participant:void 0,b?h(Number(b.amountRaised),Number(b.goal)):h()}}),a.personalDonors={page:1},g=angular.element(".js--personal-donors .team-honor-list-row"),g&&0!==g.length?1===g.length&&0===g.eq(0).find(".team-honor-list-name").length?(a.personalDonors.donors=[],a.personalDonors.totalNumber=0):(angular.forEach(g,function(b,d){var e,f;return f=angular.element(b).find(".team-honor-list-name").text(),e=angular.element(b).find(".team-honor-list-value").text(),e=e&&e.indexOf("$")!==-1?100*Number(e.replace("$","").replace(/,/g,"")):-1,a.personalDonors.donors||(a.personalDonors.donors=[]),a.personalDonors.donors.push({name:f,amount:e,amountFormatted:e===-1?"":c("currency")(e/100,"$").replace(".00","")})}),a.personalDonors.totalNumber=g.length):(f=angular.element(".js--personal-donors .scrollContent p"),f&&0!==f.length?(angular.forEach(f,function(b,d){var e,f;return f=jQuery.trim(angular.element(b).html().split("<")[0]),e=jQuery.trim(angular.element(b).html().split(">")[1]),e=e&&e.indexOf("$")!==-1?100*Number(e.replace("$","").replace(/,/g,"")):-1,a.personalDonors.donors||(a.personalDonors.donors=[]),a.personalDonors.donors.push({name:f,amount:e,amountFormatted:e===-1?"":c("currency")(e/100,"$").replace(".00","")})}),a.personalDonors.totalNumber=f.length):(a.personalDonors.donors=[],a.personalDonors.totalNumber=0))}]),angular.module("ahaLuminateControllers").controller("TeamPageCtrl",["$scope","$location",function(a,b){return a.teamId=b.absUrl().split("team_id=")[1].split("&")[0]}])}).call(this);