<div id="report">[[E16:1009:false:[[E48:[[S334:fr_id]]::team-id]]:[[S334:fr_id]]]]</div>
<style>
#report .reportTable {
  display:none;
}

legend {
  display:none;
}

@media (max-width: 768px){
  #report .reportTable {
    display:table;
  }

  #report {
    max-width:100%;
    margin:1em;
    overflow-x: scroll;
    padding-bottom: 1em;
    -webkit-overflow-scrolling:touch; 
  }
  
  td,th {
    padding: 5px;
    font-size: .75em;
  }
  
  legend {
    display:block;
    text-align:center;
    font-size:.5em;
    color:#888;
    float:none;
  }
  
  th {
    font-weight:bold;
  }
  
  #download {
    display:none;
  }
  
  #report::-webkit-scrollbar {
    width: 12px;
  }
 
   #report::-webkit-scrollbar-track {
      -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3); 
      border-radius: 10px;
  }
 
   #report::-webkit-scrollbar-thumb {
      border-radius: 10px;
      -webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.5); 
  }

}
</style>
[[?xx::x[[S334:fr_id]]x::::<script>jQuery(function($){
  var button=$("<a class='button' download='team_captain_report.csv'>Download Report</a>"),
      data=[],
      row=[],
      table=$(".reportTable").eq(0),
      value;
  
  table.find("th.reportHeading:first-child, td.reportBody:first-child, tr:last-child").remove();
  table.find("tr").each(function(i){
    row=[];
    $(this).find("td,th").each(function(j,cell){
      value=$(cell).text();
      value=value.replace(/\s+/," ").replace("NaN","--");
      if (value.search(",") > -1){
        value='"'+value+'"';
      }
      row.push(value);
    })
    data.push(row.join(","));
  })
  console.log("La la")
  data=data.join("\r\n"); 
  data=new Blob([data]);
  data=window.URL.createObjectURL(data,{type:"text/csv"})
  button.attr("href",data);
  table.after(button);
  console.log(data);
  button.css("color","white");
  if (!$(".reportTable:visible").length){
    button.get(0).click();
    setTimeout(window.close,10);
  }
})</script>]]